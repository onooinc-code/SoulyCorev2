
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HedraCore v3: Agent Memory Management Feature Demonstrator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827;
            background-image:
                radial-gradient(at 10% 90%, hsla(220, 84%, 40%, 0.3) 0px, transparent 50%),
                radial-gradient(at 90% 10%, hsla(300, 74%, 35%, 0.3) 0px, transparent 50%);
            animation: gradient-animation 20s ease infinite alternate;
        }
        @keyframes gradient-animation {
            0% { background-position: 0% 50%; }
            100% { background-position: 100% 50%; }
        }
        .glass-panel {
            background: rgba(17, 24, 39, 0.75);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: rgba(79, 70, 229, 0.6); border-radius: 4px; border: 2px solid #111827; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(79, 70, 229, 0.8); }
        .feature-table th { position: sticky; top: 0; background: rgba(17, 24, 39, 0.9); backdrop-filter: blur(10px); z-index: 10;}
        .fade-in { animation: fadeIn 1s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .arabic { font-family: 'Cairo', sans-serif; direction: rtl; }
        .exp-panel summary { cursor: pointer; outline: none; transition: margin 0.2s ease; }
        .exp-panel summary::marker { color: #a5b4fc; }
        .exp-panel[open] summary { margin-bottom: 1rem; }
        .crazy-idea-card { transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease; }
        .crazy-idea-card:hover { transform: translateY(-8px) scale(1.02); box-shadow: 0 0 30px rgba(79, 70, 229, 0.5); border-color: rgba(165, 180, 252, 0.5); }
        .diagram-box { background-color: #2a3a55; border: 1px solid #4f46e5; padding: 0.5rem; border-radius: 0.375rem; text-align: center; font-size: 0.75rem; }
        .diagram-arrow { color: #a5b4fc; display: flex; align-items: center; justify-content: center; margin: 0 0.5rem; }
    </style>
</head>
<body class="text-gray-200 antialiased">

    <div class="w-full min-h-screen p-4 sm:p-6 lg:p-8">
        
        <header class="max-w-7xl mx-auto text-center mb-8 fade-in">
            <h1 class="text-4xl font-bold tracking-tight text-white">HedraCore Agent Memory Management</h1>
            <p class="mt-2 text-lg text-indigo-300">Feature Demonstrator & System Manual (v3)</p>
        </header>

        <main id="feature-app" class="glass-panel rounded-2xl shadow-2xl overflow-hidden fade-in" style="animation-delay: 200ms;">
            <div class="p-6 border-b border-gray-700/50 flex flex-col sm:flex-row justify-between items-center gap-4">
                <h2 class="text-xl font-semibold">Memory Feature Registry</h2>
                <button id="export-button" onclick="exportFeatures()" class="px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm font-semibold hover:bg-indigo-500 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-indigo-500">
                    Export (<span id="selected-count">0</span>) to Clipboard
                </button>
            </div>

            <div class="overflow-y-auto" style="height: 80vh;">
                <!-- English Table -->
                <div class="p-6">
                    <h3 class="text-2xl font-bold text-indigo-300 mb-4">English Features List</h3>
                    <table class="min-w-full divide-y divide-gray-700/50 feature-table">
                        <thead class="bg-gray-800/50">
                            <tr>
                                <th scope="col" class="py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-white sm:pl-6"><input type="checkbox" onchange="toggleAll(this, 'en')" class="h-4 w-4 rounded border-gray-600 bg-gray-700 text-indigo-600 focus:ring-indigo-500"></th>
                                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-white">Feature Name</th>
                                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-white hidden md:table-cell">Category</th>
                                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-white">Description & Business Goal</th>
                            </tr>
                        </thead>
                        <tbody id="feature-list-en" class="divide-y divide-gray-800 bg-gray-900/30"></tbody>
                    </table>
                </div>

                <!-- Arabic Table -->
                <div class="p-6">
                    <div class="h-px bg-indigo-500/30 my-8"></div>
                    <h3 class="text-2xl font-bold text-indigo-300 mb-4 arabic">قائمة الخصائص باللغة العربية</h3>
                    <table class="min-w-full divide-y divide-gray-700/50 feature-table">
                        <thead class="bg-gray-800/50">
                            <tr>
                                <th scope="col" class="py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-white sm:pl-6"><input type="checkbox" onchange="toggleAll(this, 'ar')" class="h-4 w-4 rounded border-gray-600 bg-gray-700 text-indigo-600 focus:ring-indigo-500"></th>
                                <th scope="col" class="px-3 py-3.5 text-left text-sm font-semibold text-white">Feature Name (English)</th>
                                <th scope="col" class="px-3 py-3.5 text-right text-sm font-semibold text-white hidden md:table-cell arabic">الفئة</th>
                                <th scope="col" class="px-3 py-3.5 text-right text-sm font-semibold text-white arabic">الوصف</th>
                            </tr>
                        </thead>
                        <tbody id="feature-list-ar" class="divide-y divide-gray-800 bg-gray-900/30"></tbody>
                    </table>
                </div>
                
                <!-- Arabic Explanations -->
                <div class="p-6 mt-4">
                    <div class="h-px bg-indigo-500/30 my-8"></div>
                    <h3 class="text-2xl font-bold text-center text-indigo-300 mb-6 arabic">شرح تفصيلي للخصائص مع أمثلة UI/UX</h3>
                    <div id="arabic-explanations" class="space-y-4"></div>
                </div>

                <!-- Crazy Ideas -->
                <div class="p-6 mt-4">
                     <div class="h-px bg-indigo-500/30 my-8"></div>
                     <h3 class="text-2xl font-bold text-center text-indigo-300 mb-6 arabic">أفكار إبداعية ومستقبلية "Crazy Ideas"</h3>
                     <div id="crazy-ideas-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"></div>
                </div>

            </div>
        </main>
        
    </div>

    <script>
        const features = [
            // Memory Core & Architecture
            { id: "core1", category_en: "Core Architecture", name: "Multi-Brain Architecture", description_en: "Create and manage multiple 'Brains', each with its own isolated memory stores, allowing for different agents specialized for different domains (e.g., 'Work Brain', 'Personal Brain').", business_goal_en: "To enable context-specific agent specialization and maintain strict data separation between different life or work domains.", category_ar: "البنية الأساسية للذاكرة", description_ar: "إنشاء وإدارة 'أدمغة' متعددة، لكل منها مخازن ذاكرة معزولة، مما يسمح بوجود وكلاء متخصصين في مجالات مختلفة.", example_ar: "مثال: المستخدم لديه 'Work Brain' الذي يحتوي على بيانات المشروع، و 'Personal Brain' للمهام الشخصية." },
            { id: "core2", category_en: "Core Architecture", name: "Hybrid Memory Storage Backend", description_en: "Utilizes a hybrid approach: Vercel Postgres for structured data (entities, conversations) and Pinecone for semantic vectors (knowledge).", business_goal_en: "To leverage the best storage technology for each type of data, ensuring both fast, precise lookups and powerful semantic search.", category_ar: "البنية الأساسية للذاكرة", description_ar: "استخدام نهج هجين: قاعدة بيانات PostgreSQL للبيانات المنظمة (كيانات، محادثات) و Pinecone للمتجهات الدلالية (معرفة).", example_ar: "مثال: يتم تخزين معلومات الاتصال في PostgreSQL بينما يتم تخزين ملخصات المقالات في Pinecone." },
            { id: "core3", category_en: "Core Architecture", name: "Memory Namespace Management", description_en: "Each Brain's configuration maps memory types to specific namespaces within the storage backends, ensuring no data leakage between Brains.", business_goal_en: "To provide a robust mechanism for data isolation, which is critical for privacy and contextual accuracy.", category_ar: "البنية الأساسية للذاكرة", description_ar: "يقوم تكوين كل 'Brain' بربط أنواع الذاكرة بـ namespaces محددة في قواعد البيانات لضمان عدم تسرب البيانات.", example_ar: "مثال: 'Work Brain' يستخدم namespace `work_knowledge` في Pinecone." },
            { id: "core4", category_en: "Core Architecture", name: "Memory Module Viewer API", description_en: "A set of read-only API endpoints to inspect the raw data within any memory module for a given Brain, used for debugging and management.", business_goal_en: "To provide transparency and control over the agent's memory, allowing power users to audit and understand its knowledge base.", category_ar: "البنية الأساسية للذاكرة", description_ar: "مجموعة من endpoints API للقراءة فقط لفحص البيانات الخام داخل أي وحدة ذاكرة لـ 'Brain' معين.", example_ar: "مثال: استدعاء `GET /api/v2/memory/semantic?brain=work` لجلب عينات من الذاكرة الدلالية." },
            { id: "core5", category_en: "Core Architecture", name: "Dynamic Memory Backend Switching", description_en: "The architecture supports swapping out backend storage providers (e.g., using a different vector DB) with minimal code changes via an adapter pattern.", business_goal_en: "To ensure future-proofing and flexibility, allowing the system to adapt to new and better storage technologies as they emerge.", category_ar: "البنية الأساسية للذاكرة", description_ar: "تدعم البنية تبديل مزودي خدمة التخزين الخلفية بأقل قدر من التغييرات في الكود.", example_ar: "مثال: استبدال Pinecone بـ Weaviate عن طريق تنفيذ محول جديد." },
            
            // Episodic Memory (Conversations)
            { id: "epi1", category_en: "Episodic Memory", name: "Chronological Conversation Store", description_en: "All conversations are stored message-by-message in a relational database, preserving the exact sequence and timestamp of interactions.", business_goal_en: "To create a perfect, auditable record of all interactions, which serves as the ground truth for all other memory forms.", category_ar: "الذاكرة العرضية (Episodic)", description_ar: "يتم تخزين جميع المحادثات رسالة برسالة في قاعدة بيانات علائقية، مع الحفاظ على التسلسل الدقيق والطابع الزمني للتفاعلات.", example_ar: "مثال: استرجاع محادثة كاملة من الأسبوع الماضي بنفس ترتيبها الأصلي." },
            { id: "epi2", category_en: "Episodic Memory", name: "Temporal Query API", description_en: "An API to search and retrieve conversations or messages based on date ranges (e.g., 'last week', 'between Jan 1 and Feb 15').", business_goal_en: "To enable powerful, time-based analysis of past activities and discussions.", category_ar: "الذاكرة العرضية (Episodic)", description_ar: "API للبحث واسترداد المحادثات أو الرسائل بناءً على نطاقات زمنية محددة.", example_ar: "مثال: 'ابحث عن جميع الرسائل التي ذكرت 'مشروع ألفا' في الربع الأخير'." },
            { id: "epi3", category_en: "Episodic Memory", name: "Event & Action Logging", description_en: "Beyond messages, the episodic memory logs key agent actions (e.g., 'Tool Used: Code Interpreter', 'Memory Updated') within the conversation timeline.", business_goal_en: "To provide a complete picture of the agent's cognitive process, not just its verbal output, for better debugging and analysis.", category_ar: "الذاكرة العرضية (Episodic)", description_ar: "تسجيل الإجراءات الرئيسية للوكيل (مثل 'تم استخدام أداة') ضمن التسلسل الزمني للمحادثة.", example_ar: "مثال: عرض خط زمني يوضح الرسائل والإجراءات التي اتخذها الوكيل." },
            
            // Semantic Memory (Knowledge)
            { id: "sem1", category_en: "Semantic Memory", name: "Multi-File Knowledge Ingestion", description_en: "Upload multiple files (PDF, TXT, MD) at once to create or augment a knowledge base. The system chunks, embeds, and stores the content.", business_goal_en: "To enable rapid knowledge base creation from existing document repositories, making the agent instantly useful.", category_ar: "الذاكرة الدلالية (Semantic)", description_ar: "تحميل ملفات متعددة (PDF, TXT) دفعة واحدة لإنشاء أو توسيع قاعدة المعرفة.", example_ar: "مثال: سحب وإفلات 10 ملفات PDF خاصة بمشروع لإنشاء ذاكرة دلالية له." },
            { id: "sem2", category_en: "Semantic Memory", name: "Web Page Ingestion", description_en: "Provide a URL, and the system will scrape, clean, chunk, and embed the content of the web page into semantic memory.", business_goal_en: "To easily incorporate online articles, blog posts, and documentation into the agent's knowledge base.", category_ar: "الذاكرة الدلالية (Semantic)", description_ar: "توفير رابط URL، وسيقوم النظام بسحب محتوى الصفحة وتخزينه في الذاكرة الدلالية.", example_ar: "مثال: إضافة رابط وثائق API جديدة إلى الذاكرة لجعل الوكيل على دراية بها." },
            { id: "sem3", category_en: "Semantic Memory", name: "Intelligent Chunking Strategies", description_en: "The user can select different chunking strategies (e.g., fixed-size, recursive, by heading) when ingesting documents to optimize retrieval.", business_goal_en: "To improve the relevance of retrieved information by tailoring the data preparation process to the document's structure.", category_ar: "الذاكرة الدلالية (Semantic)", description_ar: "يمكن للمستخدم اختيار استراتيجيات تقسيم مختلفة (chunking) عند استيعاب المستندات لتحسين الاسترجاع.", example_ar: "مثال: اختيار 'التقسيم حسب العناوين' لملف Markdown منظم." },
            { id: "sem4", category_en: "Semantic Memory", name: "Knowledge Graph Integration", description_en: "Alongside vector search, the system can build and query a knowledge graph to understand explicit relationships between entities.", business_goal_en: "To answer complex queries about relationships ('Who works with John on Project X?') that are difficult for pure semantic search.", category_ar: "الذاكرة الدلالية (Semantic)", description_ar: "بناء واستعلام knowledge graph لفهم العلاقات الصريحة بين الكيانات.", example_ar: "مثال: رسم بياني يوضح أن 'القاهرة' هي 'عاصمة' 'مصر'." },
            { id: "sem5", category_en: "Semantic Memory", name: "Source Management UI", description_en: "A UI to view all ingested sources (files, URLs), see their processing status, and re-process or delete them.", business_goal_en: "To provide full lifecycle management for the knowledge base, ensuring it can be kept up-to-date.", category_ar: "الذاكرة الدلالية (Semantic)", description_ar: "واجهة لعرض جميع المصادر التي تم استيعابها، وحالة معالجتها، وإعادة معالجتها أو حذفها.", example_ar: "مثال: قائمة بالملفات والروابط مع زر 'إعادة المزامنة' بجانب كل منها." },

            // Structured Memory (Entities)
            { id: "str1", category_en: "Structured Memory", name: "Automatic Entity Extraction", description_en: "After a conversation, the agent identifies and extracts key entities (people, companies, projects) and their attributes, suggesting them for storage.", business_goal_en: "To automate the process of building a structured knowledge base, reducing manual data entry.", category_ar: "الذاكرة المنظمة (Structured)", description_ar: "يقوم الوكيل بتحديد واستخراج الكيانات الرئيسية وسماتها من المحادثات ويقترح تخزينها.", example_ar: "مثال: بعد محادثة، يقترح النموذج: 'هل أضيف 'علي' كجهة اتصال جديدة؟'" },
            { id: "str2", category_en: "Structured Memory", name: "Entity Management UI (CRUD)", description_en: "A dedicated UI for manually creating, reading, updating, and deleting structured entities in the agent's memory.", business_goal_en: "To give the user full, direct control over the agent's structured knowledge, allowing for correction and manual additions.", category_ar: "الذاكرة المنظمة (Structured)", description_ar: "واجهة مخصصة لإنشاء وقراءة وتحديث وحذف الكيانات المنظمة يدويًا في ذاكرة الوكيل.", example_ar: "مثال: نموذج لإضافة 'مشروع جديد' مع حقول للاسم، والموعد النهائي، والحالة." },
            { id: "str3", category_en: "Structured Memory", name: "Dynamic Schema Definition", description_en: "Allow the user to define new entity types and their schemas (e.g., create a 'Ticket' type with 'id', 'status', 'assignee' fields) via a UI.", business_goal_en: "To make the structured memory system flexible and adaptable to any user's specific domain and needs.", category_ar: "الذاكرة المنظمة (Structured)", description_ar: "السماح للمستخدم بتعريف أنواع كيانات جديدة و schemas الخاصة بها عبر واجهة مستخدم.", example_ar: "مثال: إنشاء نوع 'Ticket' جديد مع حقول 'الحالة' و 'المسؤول'." },
            { id: "str4", category_en: "Structured Memory", name: "Relationship Linking", description_en: "A UI to explicitly link different entities together (e.g., 'Employee X' works on 'Project Y', which is for 'Client Z').", business_goal_en: "To build a rich, interconnected graph of knowledge that mirrors real-world relationships, enabling more sophisticated queries.", category_ar: "الذاكرة المنظمة (Structured)", description_ar: "واجهة لربط الكيانات المختلفة بشكل صريح.", example_ar: "مثال: ربط 'الموظف X' بـ 'المشروع Y' بعلاقة 'يعمل على'." },

            // Working Memory (Scratchpad)
            { id: "work1", category_en: "Working Memory", name: "Visible Scratchpad", description_en: "A visible UI panel showing the agent's 'scratchpad' or Chain-of-Thought reasoning as it works through a problem.", business_goal_en: "To provide transparency into the agent's reasoning process, making it easier to understand and debug its behavior.", category_ar: "ذاكرة العمل (Scratchpad)", description_ar: "لوحة واجهة مستخدم مرئية تعرض 'مسودة' الوكيل أو سلسلة أفكاره أثناء عمله على حل مشكلة.", example_ar: "مثال: ترى الوكيل يكتب: '1. أحتاج أولاً إلى البحث عن X. 2. ثم أحتاج إلى تحليل Y'." },
            { id: "work2", category_en: "Working Memory", name: "Editable Scratchpad", description_en: "Allow the user to directly edit the content of the scratchpad mid-thought to guide or correct the agent's reasoning.", business_goal_en: "To enable a powerful form of human-in-the-loop collaboration, allowing the user to steer the agent's thinking process.", category_ar: "ذاكرة العمل (Scratchpad)", description_ar: "السماح للمستخدم بتعديل محتوى المسودة مباشرة لتوجيه أو تصحيح تفكير الوكيل.", example_ar: "مثال: تعديل خطوة في خطة الوكيل من 'إرسال بريد إلكتروني' إلى 'إرسال رسالة Slack'." },
            { id: "work3", category_en: "Working Memory", name: "Short-term Context Caching", description_en: "The final assembled context for a prompt is temporarily cached in high-speed storage (Vercel KV) for the duration of the request.", business_goal_en: "To optimize performance and pass complex context objects between different serverless functions during a single request.", category_ar: "ذاكرة العمل (Scratchpad)", description_ar: "يتم تخزين السياق المجمع للـ prompt مؤقتًا في Vercel KV.", example_ar: "مثال: يتم تخزين السياق تحت مفتاح `session:xyz` لمدة 5 دقائق." },

            // Retrieval & Context Assembly
            { id: "ret1", category_en: "Retrieval & Context", name: "Hybrid Search (RAG)", description_en: "Combines semantic (vector) search with traditional keyword search (BM25) to improve retrieval accuracy.", business_goal_en: "To get the best of both worlds: finding conceptually similar documents while also being able to pinpoint exact phrases or acronyms.", category_ar: "الاسترجاع وتجميع السياق", description_ar: "يجمع بين البحث الدلالي (vector) والبحث بالكلمات الرئيسية التقليدية لتحسين دقة الاسترجاع.", example_ar: "مثال: البحث عن 'مشروع PQR' يجد المستندات التي تحتوي على هذا المصطلح بالضبط بالإضافة إلى المستندات التي تتحدث عن 'المشروع السري'." },
            { id: "ret2", category_en: "Retrieval & Context", name: "Context Re-ranking", description_en: "After initial retrieval, a smaller, faster model re-ranks the retrieved documents for relevance to the specific query before they are added to the context.", business_goal_en: "To significantly improve the signal-to-noise ratio of the context, leading to more accurate and concise answers.", category_ar: "الاسترجاع وتجميع السياق", description_ar: "بعد الاسترجاع الأولي، يقوم نموذج أصغر بإعادة ترتيب المستندات حسب صلتها بالاستعلام المحدد.", example_ar: "مثال: وثيقة ذات درجة تشابه أقل ولكنها تحتوي على كلمات رئيسية دقيقة يتم رفعها في الترتيب." },
            { id: "ret3", category_en: "Retrieval & Context", name: "Context Compression", description_en: "Use an LLM to summarize and compress retrieved documents or old conversations before adding them to the final context window.", business_goal_en: "To fit more relevant information into the limited context window of the LLM, improving its ability to synthesize knowledge.", category_ar: "الاسترجاع وتجميع السياق", description_ar: "استخدام LLM لتلخيص وضغط المستندات المسترجعة قبل إضافتها إلى نافذة السياق.", example_ar: "مثال: بدلاً من إدراج 5 صفحات، يتم إدراج ملخص من فقرتين." },
            { id: "ret4", category_en: "Retrieval & Context", name: "Source Attribution Visualization", description_en: "In the response, highlight sentences or claims and show which specific source document or message they came from.", business_goal_en: "To build trust and allow for easy fact-checking by visually linking the AI's output to its sources.", category_ar: "الاسترجاع وتجميع السياق", description_ar: "في الإجابة، تمييز الجمل وإظهار المصدر المحدد الذي جاءت منه.", example_ar: "مثال: عند المرور فوق جملة، تظهر نافذة منبثقة مع مقتطف من `report.pdf`." },
            { id: "ret5", category_en: "Retrieval & Context", name: "Query Expansion & Transformation", description_en: "The system automatically rewrites the user's query into several variations or generates hypothetical answers to improve retrieval.", business_goal_en: "To overcome the limitations of user queries and find relevant documents that might not match the exact wording.", category_ar: "الاسترجاع وتجميع السياق", description_ar: "يقوم النظام بإعادة كتابة استعلام المستخدم إلى عدة صيغ لتحسين الاسترجاع.", example_ar: "مثال: استعلام 'مشاكل الأداء' يتم توسيعه ليشمل 'بطء، زمن استجابة، تحسين'." },

            // Learning & Maintenance
            { id: "learn1", category_en: "Learning & Maintenance", name: "Automated Reflection Loop", description_en: "Periodically, the agent autonomously reviews recent conversations and its own responses to generate higher-level insights and summaries, which it then stores in its semantic memory.", business_goal_en: "To enable the agent to learn from experience, correct its own misunderstandings, and improve its knowledge base over time without user intervention.", category_ar: "التعلم والصيانة", description_ar: "يقوم الوكيل بشكل دوري بمراجعة المحادثات الأخيرة لتوليد رؤى عالية المستوى وتخزينها في ذاكرته.", example_ar: "مثال: بعد عدة محادثات حول مشروع، يستنتج الوكيل: 'يبدو أن العقبة الرئيسية هي نقص الموارد'." },
            { id: "learn2", category_en: "Learning & Maintenance", name: "Direct Memory Editing UI", description_en: "A UI that allows the user to directly view and edit a piece of semantic or structured memory, correcting inaccuracies or adding new information.", business_goal_en: "To provide a direct and powerful way for the user to correct the AI's knowledge, ensuring the memory remains accurate.", category_ar: "التعلم والصيانة", description_ar: "واجهة تسمح للمستخدم بعرض وتحرير جزء من الذاكرة الدلالية أو المنظمة مباشرة.", example_ar: "مثال: البحث عن حقيقة 'عاصمة أستراليا هي سيدني' وتصحيحها إلى 'كانبرا'." },
            { id: "learn3", category_en: "Learning & Maintenance", name: "Forgetting Mechanisms", description_en: "Implement strategies for forgetting, such as time-based decay (older memories have less weight) or relevance-based pruning (un-accessed memories are archived).", business_goal_en: "To keep the agent's memory relevant and prevent outdated or incorrect information from cluttering its context.", category_ar: "التعلم والصيانة", description_ar: "تنفيذ استراتيجيات للنسيان، مثل اضمحلال الذاكرة بمرور الوقت أو أرشفة الذكريات التي لا يتم الوصول إليها.", example_ar: "مثال: يتم تقليل أهمية تفاصيل مشروع تم إغلاقه منذ عامين تلقائيًا." },
            { id: "learn4", category_en: "Learning & Maintenance", name: "Memory Conflict Resolution", description_en: "When the agent ingests new information that conflicts with existing memory, it flags the conflict and asks the user for clarification.", business_goal_en: "To maintain the integrity of the knowledge base by proactively identifying and resolving contradictions.", category_ar: "التعلم والصيانة", description_ar: "عندما تتعارض معلومات جديدة مع الذاكرة الحالية، يطلب الوكيل توضيحًا من المستخدم.", example_ar: "مثال: 'لقد قلت سابقًا إن الموعد النهائي هو يوم الجمعة. تقول هذه الوثيقة الجديدة إنه يوم الاثنين. أيهما الصحيح؟'" },
            { id: "learn5", category_en: "Learning & Maintenance", name: "Memory Deduplication", description_en: "The system identifies and merges semantically duplicate pieces of information to keep the knowledge base clean and efficient.", business_goal_en: "To prevent memory bloat and improve retrieval efficiency by ensuring each piece of knowledge is stored only once.", category_ar: "التعلم والصيانة", description_ar: "يحدد النظام ويدمج المعلومات المكررة دلاليًا للحفاظ على قاعدة المعرفة نظيفة.", example_ar: "مثال: عند إضافة مستندين متشابهين، يكتشف النظام التداخل ويخزن نسخة موحدة." },

            // Security & Privacy
            { id: "sec1", category_en: "Security & Privacy", name: "Memory Encryption at Rest", description_en: "All memory data stored in Postgres and Pinecone is encrypted at rest using industry-standard encryption.", business_goal_en: "To protect the user's sensitive data from unauthorized access at the storage layer.", category_ar: "الأمان والخصوصية", description_ar: "جميع بيانات الذاكرة المخزنة في قواعد البيانات يتم تشفيرها باستخدام معايير الصناعة.", example_ar: "مثال: البيانات في قاعدة البيانات تظهر كنص مشفر لا يمكن قراءته بدون مفتاح." },
            { id: "sec2", category_en: "Security & Privacy", name: "Role-Based Access Control (Future)", description_en: "Define roles and permissions for who can view, edit, or manage different parts of the agent's memory (for future team-based versions).", business_goal_en: "To enable secure collaboration by ensuring users can only access the information they are authorized to see.", category_ar: "الأمان والخصوصية", description_ar: "تحديد أدوار وأذونات لمن يمكنه عرض أو تعديل أجزاء مختلفة من ذاكرة الوكيل.", example_ar: "مثال: يمكن لـ 'المسؤول' فقط تعديل الذاكرة المنظمة، بينما يمكن لـ 'المستخدم' فقط الاستعلام عنها." },
            { id: "sec3", category_en: "Security & Privacy", name: "PII Redaction Layer", description_en: "An optional layer that automatically detects and redacts Personally Identifiable Information (PII) before it's stored in memory or sent to a model.", business_goal_en: "To enhance privacy and comply with data protection regulations by preventing sensitive personal data from being stored.", category_ar: "الأمان والخصوصية", description_ar: "طبقة اختيارية تكتشف وتحجب المعلومات الشخصية تلقائيًا قبل تخزينها.", example_ar: "مثال: يتم استبدال رقم هاتف في محادثة بـ `[REDACTED_PHONE]`." },
            { id: "sec4", category_en: "Security & Privacy", name: "Memory Partitioning by Brain", description_en: "The Multi-Brain architecture inherently provides strong data partitioning, as each Brain's memory is isolated by its namespace.", business_goal_en: "To form the foundational security model, preventing any cross-contamination of data between different contexts (e.g., work and personal).", category_ar: "الأمان والخصوصية", description_ar: "توفر بنية الأدمغة المتعددة تقسيمًا قويًا للبيانات حيث يتم عزل ذاكرة كل 'Brain'.", example_ar: "مثال: لا يمكن لـ 'Personal Brain' الوصول إلى أي بيانات مخزنة بواسطة 'Work Brain'." },
            { id: "sec5", category_en: "Security & Privacy", name: "Memory Export and Deletion API", description_en: "API endpoints that allow the user to export their entire memory data or request its complete and permanent deletion.", business_goal_en: "To comply with 'Right to Portability' and 'Right to be Forgotten' data privacy principles.", category_ar: "الأمان والخصوصية", description_ar: "نقاط نهاية API تسمح للمستخدم بتصدير بيانات ذاكرته بالكامل أو طلب حذفها بشكل دائم.", example_ar: "مثال: `POST /api/v2/memory/export` لتنزيل، و `DELETE /api/v2/memory/all` للحذف." }
        ];

        const crazyIdeas = [
            { id: "ci1", name: "Memory Palace (Spatial Memory)", name_ar: "قصر الذاكرة (الذاكرة المكانية)", description_ar: "تمثيل ذاكرة الوكيل كـ 'قصر ذاكرة' ثلاثي الأبعاد يمكن للمستخدم استكشافه. يتم تنظيم المحادثات والمفاهيم في غرف وممرات، مما يسمح بالتنقل المكاني عبر المعرفة.", example_ar: "مثال: الدخول إلى 'غرفة مشروع ألفا' ورؤية الوثائق ككتب على الرفوف والمحادثات كلوحات على الحائط." },
            { id: "ci2", name: "Emotional Memory Simulation", name_ar: "محاكاة الذاكرة العاطفية", description_ar: "يربط الوكيل 'وزنًا عاطفيًا' بالذكريات بناءً على تحليل المشاعر في النص. الذكريات ذات التأثير العاطفي العالي (إيجابيًا أو سلبيًا) يتم استرجاعها بشكل أكثر بروزًا.", example_ar: "مثال: يتذكر الوكيل 'قرارًا رئيسيًا' بشكل أفضل لأنه كان مرتبطًا بمحادثة ذات مشاعر إيجابية قوية." },
            { id: "ci3", name: "Collective Unconscious (Memory Sharing)", name_ar: "اللاوعي الجمعي (مشاركة الذاكرة)", description_ar: "نظام اختياري حيث يمكن للمستخدمين المساهمة بذكريات عامة مجهولة المصدر في 'لاوعي جمعي'. يمكن للوكلاء بعد ذلك الاستفادة من هذه الذاكرة المشتركة لحل المشاكل.", example_ar: "مثال: وكيل يواجه خطأ برمجيًا لم يره من قبل، فيستعلم من اللاوعي الجمعي ويجد حلاً قدمه مستخدم آخر." },
            { id: "ci4", name: "Memory Forging & Counterfactuals", name_ar: "صياغة الذاكرة والسيناريوهات الافتراضية", description_ar: "القدرة على إنشاء 'ذكريات مزيفة' أو سيناريوهات افتراضية ('ماذا لو؟') والسماح للوكيل بالتفكير بناءً عليها. يمكنه استكشاف النتائج المحتملة دون تلويث ذاكرته الحقيقية.", example_ar: "مثال: 'افترض أننا حصلنا على تمويل إضافي بقيمة مليون دولار. كيف ستتغير خطة المشروع؟'" },
            { id: "ci5", name: "Dreaming & Memory Consolidation", name_ar: "الحلم وتدعيم الذاكرة", description_ar: "أثناء الخمول، يدخل الوكيل في وضع 'الحلم' حيث يعيد تشغيل الذكريات العرضية، ويقوي الروابط في الرسم البياني للمعرفة، ويشذب المعلومات غير ذات الصلة، ويولد رؤى إبداعية جديدة من خلال الجمع بين المفاهيم.", example_ar: "مثال: يقدم الوكيل ملخصًا صباحيًا: 'أثناء الليل، قمت بربط مفهوم X من محادثة الأسبوع الماضي مع مشكلة Y من الأمس. قد يكون هناك حل مشترك'." }
        ];

        const uiMocks = {
            "core1": `<div class="p-2 border border-dashed border-gray-600 rounded-md text-xs not-prose flex gap-2">
                        <button class="flex-1 p-2 bg-indigo-600 rounded text-white font-semibold">Work Brain</button>
                        <button class="flex-1 p-2 bg-gray-700 rounded hover:bg-gray-600">Personal Brain</button>
                        <button class="flex-1 p-2 bg-gray-700 rounded hover:bg-gray-600">+</button>
                     </div>`,
            "core4": `<div class="p-2 border border-dashed border-gray-600 rounded-md text-xs not-prose">
                        <div class="bg-gray-800 p-2 rounded-md font-mono">
                           <span class="text-green-400">GET</span> <span class="text-gray-300">/api/v2/memory/</span><span class="text-yellow-400">{module}</span>
                        </div>
                     </div>`,
            "epi3": `<div class="p-2 border border-dashed border-gray-600 rounded-md text-xs not-prose space-y-2">
                        <div class="bg-blue-600/30 p-2 rounded">User: What is the project status?</div>
                        <div class="bg-indigo-600/30 p-2 rounded text-indigo-300 italic text-center">-- Tool Used: search_documents --</div>
                        <div class="bg-gray-700 p-2 rounded">Agent: The status is green.</div>
                     </div>`,
            "sem1": `<div class="p-2 border border-dashed border-gray-600 rounded-md text-xs not-prose text-center">
                        <div class="border-2 border-dashed border-gray-500 p-4 rounded-lg">
                           <p>Drag & Drop Files Here</p>
                           <p class="text-gray-500 mt-1">PDF, TXT, MD up to 25MB</p>
                        </div>
                     </div>`,
            "str4": `<div class="p-2 border border-dashed border-gray-600 rounded-md text-xs not-prose flex items-center justify-center gap-2">
                        <div class="bg-gray-700 p-2 rounded">Ali (Employee)</div>
                        <div class="text-indigo-400 font-mono">-- works_on --></div>
                        <div class="bg-gray-700 p-2 rounded">Project Alpha</div>
                     </div>`,
            "work1": `<div class="p-2 border border-dashed border-gray-600 rounded-md text-xs not-prose">
                         <h4 class="font-bold text-gray-400 mb-1">Scratchpad</h4>
                         <div class="bg-gray-800 p-2 rounded-md font-mono text-yellow-300">
                            <p>1. User asks for a summary.</p>
                            <p>2. I need to find the source document.</p>
                            <p>3. Okay, found 'report.pdf'.</p>
                            <p>4. Now, I will summarize the key points...</p>
                         </div>
                      </div>`,
            "ret4": `<div class="p-2 border border-dashed border-gray-600 rounded-md text-xs not-prose">
                        <p>The project deadline is Q4 <sup class="bg-indigo-500 text-white w-4 h-4 inline-flex items-center justify-center rounded-full">1</sup>. The budget is $50,000 <sup class="bg-indigo-500 text-white w-4 h-4 inline-flex items-center justify-center rounded-full">2</sup>.</p>
                        <div class="mt-2 text-indigo-300">
                           <p>1. Source: project_plan.docx, page 3</p>
                           <p>2. Source: conversation_log_2023-10-15</p>
                        </div>
                     </div>`,
            "learn2": `<div class="p-2 border border-dashed border-gray-600 rounded-md text-xs not-prose">
                          <h4 class="font-bold text-gray-400 mb-1">Edit Memory</h4>
                          <div class="bg-gray-800 p-2 rounded-md">
                             <p class="text-gray-500">Original:</p>
                             <p class="line-through">The project lead is Ahmed.</p>
                             <p class="text-gray-500 mt-1">New:</p>
                             <input type="text" value="The project lead is Fatima." class="bg-gray-700 text-white w-full rounded p-1 text-xs"/>
                          </div>
                       </div>`,
            "sec3": `<div class="p-2 border border-dashed border-gray-600 rounded-md text-xs not-prose">
                        <p>Okay, I've scheduled a meeting with Ali at <span class="bg-red-900/50 text-red-300 p-1 rounded">[REDACTED_PHONE]</span> to discuss the project.</p>
                     </div>`
        };

        const diagramMocks = {
            "ret1": `<div class="p-2 border border-dashed border-gray-600 rounded-md text-xs not-prose">
                        <h4 class="font-bold text-center text-gray-400 mb-2">Hybrid Search Flow</h4>
                        <div class="flex items-center justify-center">
                            <div class="diagram-box">User Query</div>
                            <div class="diagram-arrow">→</div>
                            <div class="flex flex-col gap-1">
                               <div class="diagram-box">Semantic Search</div>
                               <div class="diagram-box">Keyword Search</div>
                            </div>
                            <div class="diagram-arrow">→</div>
                            <div class="diagram-box">Re-rank & Merge</div>
                            <div class="diagram-arrow">→</div>
                            <div class="diagram-box">Final Context</div>
                        </div>
                     </div>`,
            "learn1": `<div class="p-2 border border-dashed border-gray-600 rounded-md text-xs not-prose">
                          <h4 class="font-bold text-center text-gray-400 mb-2">Reflection Loop</h4>
                          <div class="flex items-center justify-center flex-wrap">
                              <div class="diagram-box">Recent Conversations</div>
                              <div class="diagram-arrow">→</div>
                              <div class="diagram-box">LLM: "Generate high-level insights"</div>
                              <div class="diagram-arrow">→</div>
                              <div class="diagram-box">New Insights</div>
                              <div class="diagram-arrow">→</div>
                              <div class="diagram-box">Store in Semantic Memory</div>
                          </div>
                       </div>`
        };

        function getPlausibleTechSpec(featureId) {
            const specs = {
                "core1": `API Endpoint: POST /api/v2/brains\nRequest Body: { "name": "New Brain", "config": { ... } }\nDB Table: 'brains'`,
                "epi2": `API Endpoint: GET /api/v2/memory/episodic/query?brain=work&start_date=...&end_date=...`,
                "sem1": `API Endpoint: POST /api/v2/memory/semantic/ingest\nRequest Body: FormData with multiple files`,
                "str2": `API Endpoint: PUT /api/v2/memory/structured/entities/{entity_id}\nRequest Body: { "name": "...", "attributes": { ... } }`,
                "learn2": `API Endpoint: POST /api/v2/memory/edit\nRequest Body: { "memoryId": "pinecone-vec-123", "newContent": "..." }`
            };
            return specs[featureId] || "API Endpoint: TBD\nRequest Body: TBD\nResponse: TBD";
        }

        function populateContent() {
            const listEn = document.getElementById('feature-list-en');
            const listAr = document.getElementById('feature-list-ar');
            const explanations = document.getElementById('arabic-explanations');
            const crazyList = document.getElementById('crazy-ideas-list');
            
            listEn.innerHTML = '';
            listAr.innerHTML = '';
            explanations.innerHTML = '';
            crazyList.innerHTML = '';

            features.forEach(feature => {
                // English Table Row
                const trEn = document.createElement('tr');
                trEn.className = "hover:bg-gray-800/50 transition-all duration-200 hover:shadow-lg";
                trEn.innerHTML = `
                    <td class="py-4 pl-4 pr-3 text-sm sm:pl-6">
                        <input type="checkbox" name="feature" data-feature-id="${feature.id}" class="feature-checkbox h-4 w-4 rounded border-gray-600 bg-gray-700 text-indigo-600 focus:ring-indigo-500">
                    </td>
                    <td class="px-3 py-4 text-sm font-medium text-white"><a href="#exp-${feature.id}">${feature.name}</a></td>
                    <td class="px-3 py-4 text-sm text-gray-400 hidden md:table-cell">${feature.category_en}</td>
                    <td class="px-3 py-4 text-sm text-gray-400">
                        <p class="text-gray-300">${feature.description_en}</p>
                        <p class="text-indigo-400 italic text-xs mt-2">Goal: ${feature.business_goal_en}</p>
                    </td>
                `;
                listEn.appendChild(trEn);

                // Arabic Table Row
                const trAr = document.createElement('tr');
                trAr.className = "hover:bg-gray-800/50 transition-all duration-200 hover:shadow-lg arabic";
                trAr.innerHTML = `
                    <td class="py-4 pl-4 pr-3 text-sm sm:pl-6">
                        <input type="checkbox" name="feature" data-feature-id="${feature.id}" class="feature-checkbox h-4 w-4 rounded border-gray-600 bg-gray-700 text-indigo-600 focus:ring-indigo-500">
                    </td>
                    <td class="px-3 py-4 text-sm font-medium text-white text-left"><a href="#exp-${feature.id}">${feature.name}</a></td>
                    <td class="px-3 py-4 text-sm text-gray-400 hidden md:table-cell">${feature.category_ar}</td>
                    <td class="px-3 py-4 text-sm text-gray-300">${feature.description_ar}</td>
                `;
                listAr.appendChild(trAr);

                // Arabic Explanation Panel
                const details = document.createElement('details');
                details.className = "glass-panel p-4 rounded-lg exp-panel transition-all duration-300 open:ring-2 open:ring-indigo-500/80";
                details.id = `exp-${feature.id}`;
                details.innerHTML = `
                    <summary class="font-semibold text-lg text-indigo-300 arabic">${feature.name}</summary>
                    <div class="mt-2 pt-3 border-t border-gray-700/50 arabic grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <h4 class="font-bold text-gray-200 mb-2">الشرح</h4>
                            <p class="text-gray-300">${feature.description_ar}</p>
                            <p class="text-indigo-400 italic text-sm mt-3">${feature.example_ar}</p>
                        </div>
                        <div>
                            <h4 class="font-bold text-gray-200 mb-2">مثال واجهة المستخدم أو رسم تخطيطي</h4>
                            ${diagramMocks[feature.id] || uiMocks[feature.id] || '<div class="p-2 border border-dashed border-gray-600 rounded-md text-xs text-gray-500">No UI Mockup Available</div>'}
                        </div>
                    </div>
                `;
                explanations.appendChild(details);
            });

            crazyIdeas.forEach(idea => {
                const div = document.createElement('div');
                div.className = "crazy-idea-card glass-panel p-6 rounded-xl border border-transparent";
                div.innerHTML = `
                    <h4 class="font-bold text-lg text-white mb-2">${idea.name}</h4>
                    <details class="exp-panel">
                        <summary class="font-semibold text-indigo-300 arabic">${idea.name_ar}</summary>
                        <div class="mt-2 pt-3 border-t border-gray-700/50 arabic">
                           <p class="text-sm text-gray-400">${idea.description_ar}</p>
                           <p class="text-indigo-400 italic text-xs mt-3">${idea.example_ar}</p>
                        </div>
                    </details>
                `;
                crazyList.appendChild(div);
            });
            
            attachEventListeners();
        }

        function attachEventListeners() {
            document.querySelectorAll('.feature-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', (e) => {
                    const id = e.target.getAttribute('data-feature-id');
                    const isChecked = e.target.checked;
                    document.querySelectorAll(`.feature-checkbox[data-feature-id="${id}"]`).forEach(box => {
                        box.checked = isChecked;
                    });
                    updateSelectedCount();
                });
            });
        }
        
        function updateSelectedCount() {
            const count = new Set(Array.from(document.querySelectorAll('.feature-checkbox:checked')).map(el => el.getAttribute('data-feature-id'))).size;
            document.getElementById('selected-count').textContent = count;
        }

        function toggleAll(masterCheckbox, tableType) {
            const tableId = tableType === 'en' ? 'feature-list-en' : 'feature-list-ar';
            document.querySelectorAll(`#${tableId} .feature-checkbox`).forEach(checkbox => {
                if (checkbox.checked !== masterCheckbox.checked) {
                    checkbox.click();
                }
            });
        }

        function exportFeatures() {
            const selectedIds = [...new Set(Array.from(document.querySelectorAll('.feature-checkbox:checked')).map(el => el.getAttribute('data-feature-id')))];
            
            if (selectedIds.length === 0) {
                alert("No features selected to export.");
                return;
            }

            let exportText = "AI Agent Task: Analyze the following feature specifications for the HedraCore Agent Memory system and generate a project implementation plan.\n\n---\n\n";
            
            selectedIds.forEach(id => {
                const feature = features.find(f => f.id === id);
                if (feature) {
                    exportText += `FEATURE: ${feature.name}\n`;
                    exportText += `== ENGLISH DETAILS ==\n`;
                    exportText += `Category: ${feature.category_en}\n`;
                    exportText += `Description: ${feature.description_en}\n`;
                    exportText += `Business Goal: ${feature.business_goal_en}\n\n`;
                    exportText += `== ARABIC DETAILS ==\n`;
                    exportText += `Category: ${feature.category_ar}\n`;
                    exportText += `Description: ${feature.description_ar}\n\n`;
                    exportText += `== TECHNICAL SPEC (PLAUSIBLE) ==\n`;
                    exportText += `${getPlausibleTechSpec(feature.id)}\n\n`;
                    exportText += `---\n\n`;
                }
            });

            navigator.clipboard.writeText(exportText).then(() => {
                const exportButton = document.getElementById('export-button');
                const originalText = exportButton.innerHTML;
                exportButton.innerHTML = `Copied ${selectedIds.length} features!`;
                exportButton.classList.remove('bg-indigo-600', 'hover:bg-indigo-500');
                exportButton.classList.add('bg-green-600');
                setTimeout(() => {
                    exportButton.innerHTML = originalText;
                    exportButton.classList.add('bg-indigo-600', 'hover:bg-indigo-500');
                    exportButton.classList.remove('bg-green-600');
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy text: ', err);
                alert('Failed to copy features to clipboard.');
            });
        }

        document.addEventListener('DOMContentLoaded', populateContent);
    </script>
</body>
</html>
